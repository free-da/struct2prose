{
  "title": "KonfigurationsÃ¼bersicht",
  "sections": [
    {
      "heading": "Konfigurationen",
      "blocks": [
        {
          "block_type": "paragraph",
          "content": "Hier\nwerden alle wesentlichen Konfigurationen fÃ¼r den laufenden Betrieb in\nPROD, TEST und DEMO festgehalten. Ã„nderungen mÃ¼ssen IMMER hier\ndokumentiert werden. Dies soll die einzige Referenz darstellen."
        },
        {
          "block_type": "paragraph",
          "content": "Diese Seite ist nicht aktuell und muss Ã¼berarbeitet werden! Stand: 26.10.2023"
        }
      ]
    },
    {
      "heading": ".profile",
      "blocks": [
        {
          "block_type": "paragraph",
          "content": "Setzt Betriebssystemparameter fÃ¼r den Benutzer. Pfad: /home/s0ftw4re/.profile"
        },
        {
          "block_type": "table",
          "content": [
            [
              "Parameter",
              "Wert"
            ],
            [
              "JAVA_BINDIR",
              "/opt/s0ftw4reweb/java/jdk/bin/"
            ],
            [
              "JAVA_HOME",
              "/opt/s0ftw4reweb/java/jdk"
            ],
            [
              "JAVA_ROOT",
              "/opt/s0ftw4reweb/java/jdk"
            ],
            [
              "JBOSS_HOME",
              "/opt/s0ftw4reweb/wildfly"
            ],
            [
              "PATH",
              "$JAVA_HOME/bin:$JBOSS_HOME/bin:$PATH2."
            ]
          ]
        }
      ]
    },
    {
      "heading": "standalone.conf",
      "blocks": [
        {
          "block_type": "paragraph",
          "content": "Wildfly Konfiguration fÃ¼r den Java-Prozess."
        },
        {
          "block_type": "paragraph",
          "content": "Pfad: /opt/s0ftw4reweb/wildfly/bin/standalone.conf"
        },
        {
          "block_type": "paragraph",
          "content": "Die vorhandenen Java Parameter (JAVA_OPTS) werden um folgende EintrÃ¤ge erweitert."
        },
        {
          "block_type": "table",
          "content": [
            [
              "",
              "Parameter",
              "Wert"
            ],
            [
              "",
              "-Dde.s0ftw4re.logpath",
              "/opt/s0ftw4reweb/logs"
            ],
            [
              "",
              "-Dmail.imap.starttls.enable",
              "True ðŸš© imap/imaps Verwendung?"
            ]
          ]
        },
        {
          "block_type": "paragraph",
          "content": "Bei dem Eintrag -Dhttp.nonProxyHosts sind die \\ Zeichen notwendig, um die | zu maskieren. Andernfalls startet der Wildfly nicht."
        },
        {
          "block_type": "paragraph",
          "content": "Der Parameter -Dmail.imap.starttls.enable wird verwendet, damit bei der Funktion \"Mit dem E-Mail Server\nverbinden\" beim Einsatz von IMAP auch eine verschlÃ¼sselte Verbindung\naufgebaut wird."
        },
        {
          "block_type": "table",
          "content": [
            [
              "Instanz-Name",
              "Parameter",
              "Wert"
            ],
            [
              "Produktiv",
              "-Xms",
              "64G"
            ],
            [
              "",
              "-Xmx",
              "64G"
            ],
            [
              "",
              "ReservedCodeCacheSize",
              "1024m"
            ],
            [
              "Test/Demo",
              "-Xms",
              "16G"
            ],
            [
              "",
              "-Xmx",
              "16G"
            ]
          ]
        }
      ]
    },
    {
      "heading": "standalone.xml",
      "blocks": [
        {
          "block_type": "paragraph",
          "content": "Pfad: /opt/s0ftw4reweb/wildfly/standalone/configuration/standalone.xml"
        }
      ]
    },
    {
      "heading": "datasource",
      "blocks": [
        {
          "block_type": "paragraph",
          "content": "Bereich datasource gemÃ¤ÃŸ den folgenden Angaben anpassen:"
        },
        {
          "block_type": "table",
          "content": [
            [
              "Instanz-Name",
              "Parameter",
              "Wert"
            ],
            [
              "Produktion",
              "jndi-name",
              "java:/database1"
            ],
            [
              "",
              "pool-name",
              "S0FTW4RE"
            ],
            [
              "",
              "connection-url",
              "jdbc:oracle:thin:@schwubs097.old.domain.de:1521/s0ftw4re"
            ],
            [
              "",
              "driver",
              "Oracle"
            ],
            [
              "",
              "user-name",
              "S0ftw4re"
            ],
            [
              "",
              "password",
              "Xxxx"
            ],
            [
              "Demo",
              "jndi-name",
              "java:/demo"
            ],
            [
              "",
              "pool-name",
              "Demo"
            ],
            [
              "",
              "connection-url",
              "jdbc:oracle:thin:@schwubs098.old.domain.de:1521:demo"
            ],
            [
              "",
              "driver",
              "Oracle"
            ],
            [
              "",
              "user-name",
              "s0ftw4re"
            ],
            [
              "",
              "password",
              "Xxxx"
            ],
            [
              "",
              "Parameter",
              "Wert"
            ],
            [
              "Test",
              "jndi-name",
              "java:/test"
            ],
            [
              "",
              "pool-name",
              "TEST"
            ],
            [
              "",
              "connection-url",
              "jdbc:oracle:thin:@srvlnx97.old.domain.de:1521/test"
            ],
            [
              "",
              "driver",
              "Oracle"
            ],
            [
              "",
              "user-name",
              "S0FTW4RE"
            ],
            [
              "",
              "password",
              "Xxxx"
            ]
          ]
        },
        {
          "block_type": "paragraph",
          "content": "Im Bereich datasource wird der folgende Block validation verwendet."
        },
        {
          "block_type": "code",
          "content": "<validation>\n<valid-connection-checker\nclass-name=\n\"org.jboss.jca.adapters.jdbc.extensions.oracle.OracleValidConnectionChecker\"\n></valid-connection-checker>\n<check-valid-connection-sql>\nselect 1 from dual\n</check-valid-connection-sql>\n<background-validation>\ntrue\n</background-validation>\n<stale-connection-checker\nclass-name=\n\"org.jboss.jca.adapters.jdbc.extensions.oracle.OracleStaleConnectionChecker\"\n></stale-connection-checker>\n<exception-sorter\nclass-name=\n\"org.jboss.jca.adapters.jdbc.extensions.oracle.OracleExceptionSorter\"\n></exception-sorter>\n</validation>"
        }
      ]
    },
    {
      "heading": "HTTP-Listener",
      "blocks": [
        {
          "block_type": "paragraph",
          "content": "Im Bereich <schwubsystem xmlns=\"urn:jboss:domain:undertow:10.0\"> wird fÃ¼r den Parameter http-listener der Wert max-post-size von 50 MB auf 200 MB erhÃ¶ht."
        },
        {
          "block_type": "code",
          "content": "<http-listener name=\"default\" socket-binding=\"http\" max-post-size=\"209715200\" max-parameters=\"10000\" url-charset=\"utf-8\" enable-http2=\"false\"></http-listener>\n#aktuelle standalone Demo\n<http-listener name=\"default\" socket-binding=\"http\" redirect-socket=\"https\" enable-http2=\"false\" max-parameters=\"10000\" url-charset=\"utf-8\" max-post-size=\"209715200\"></http-listener>"
        },
        {
          "block_type": "paragraph",
          "content": "Folgenden https-listener hinzufÃ¼gen (wenn bereits einer vorhanden ist ggf. deaktivieren):"
        },
        {
          "block_type": "code",
          "content": "<\nhttps-listener\nname\n=\n\"httpsServer\"\nsocket-binding\n=\n\"https\"\nsecurityrealm\n=\n\"ApplicationRealm\"\nmax-parameters\n=\n\"10000\"\nurl-charset\n=\n\"utf-8\"\nmax-post-size\n=\n\"209715200\"\n></\nhttps-listener\n>\n#aktuelle standalone Demo\n<\nhttps-listener\nname\n=\n\"httpsServer\"\nsocket-binding\n=\n\"https\"\nsecurity-realm\n=\n\"ApplicationRealm\"\nenable-http2\n=\n\"false\"\nmax-parameters\n=\n\"10000\"\nurl-charset\n=\n\"utf-8\"\nmax-post-size\n=\n\"209715200\"\n></\nhttps-listener\n>"
        }
      ]
    },
    {
      "heading": "Logdateien",
      "blocks": [
        {
          "block_type": "paragraph",
          "content": "Bereich: <schwubsystem xmlns=\"urn:jboss:domain:logging:8.0\"> Hier muss ebenfalls der Loglevel abgeÃ¤ndert werden, damit der logger.level=INFO und andere auf ERROR gesetzt werden kann.:"
        },
        {
          "block_type": "code",
          "content": "<console-handler\nname=\n\"CONSOLE\"\n>\n<level\nname=\n\"ERROR\"\n></level>\n<formatter>\n<named-formatter\nname=\n\"COLOR-PATTERN\"\n></named-formatter>\n</formatter>\n</console-handler>"
        },
        {
          "block_type": "paragraph",
          "content": "Sowie"
        },
        {
          "block_type": "code",
          "content": "<root-logger>\n<level\nname=\n\"ERROR\"\n></level>\n<handlers>\n<handler\nname=\n\"CONSOLE\"\n></handler>\n<handler\nname=\n\"FILE\"\n></handler>\n</handlers>\n</root-logger>"
        },
        {
          "block_type": "paragraph",
          "content": "AuÃŸerdem\nmÃ¼ssen der DAP- und S0ftw4re-Logger angeschaltet werden (alle anderen\nkÃ¶nnen auskommentiert werden. Welche davon fÃ¼r uns auch sinnvoll sein\nkÃ¶nnten, kann weiter untersucht werden). Das Loglevel wird so restriktiv\ngehandhabt wie oben definiert. Wenn ein hÃ¶heres Loglevel benÃ¶tigt wird,\noben anpassen."
        },
        {
          "block_type": "code",
          "content": "<logger\ncategory=\n\"de.s0ftw4re.dapservice\"\n>\n<level\nname=\n\"DEBUG\"\n></level>\n</logger>\n<logger\ncategory=\n\"de.s0ftw4re.system.log\"\n>\n<level\nname=\n\"DEBUG\"\n></level>\n</logger>"
        },
        {
          "block_type": "paragraph",
          "content": "FÃ¼r die Log-Rotation den <file-handler> austauschen gegen:"
        },
        {
          "block_type": "code",
          "content": "<periodic-rotating-file-handler\nname=\n\"FILE\"\nautoflush=\n\"true\"\n>\n<formatter>\n<named-formatter\nname=\n\"PATTERN\"\n></named-formatter>\n</formatter>\n<file\nrelative-to=\n\"jboss.server.log.dir\"\npath=\n\"server.log\"\n></file>\n<suffix\nvalue=\n\".yyyy-MM-dd\"\n></suffix>\n<append\nvalue=\n\"true\"\n></append>\n</periodic-rotating-file-handler>"
        }
      ]
    },
    {
      "heading": "logback.xml",
      "blocks": [
        {
          "block_type": "paragraph",
          "content": "Diese Datei hat sich zwischen v. 1.90 und 3.0 NICHT verÃ¤ndert und kann beibehalten werden!"
        },
        {
          "block_type": "paragraph",
          "content": "unter <!-- Definition des Appender fÃ¼r das Schreiben der Logdateien \"server.log\" --> den Block ersetzen durch:"
        },
        {
          "block_type": "code",
          "content": "<appender\nname=\n\"RequestLogAppender\"\nclass=\n\"ch.qos.logback.core.rolling.RollingFileAppender\"\n>\n<file>\n${JBOSS_HOME}/standalone/log/server.log\n</file>\n<rollingPolicy\nclass=\n\"ch.qos.logback.core.rolling.TimeBasedRollingPolicy\"\n>\n<!-- daily rollover -->\n<fileNamePattern>\n${JBOSS_HOME}/standalone/log/server.%d{yyyy-MM-dd}.log.zip\n</fileNamePattern>\n<!-- keep 30 days' worth of history capped at 3GB total size -->\n<maxHistory>\n30\n</maxHistory>\n<totalSizeCap>\n3GB\n</totalSizeCap>\n</rollingPolicy>\n<triggeringPolicy\nclass=\n\"ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy\"\n>\n<maxFileSize>\n100MB\n</maxFileSize>\n</triggeringPolicy>\n<encoder>\n<pattern>\n%d %-5p [%thread] [%c] %m%n\n</pattern>\n</encoder>\n</appender>"
        },
        {
          "block_type": "paragraph",
          "content": "folgende Logger werden fÃ¼r TEST und fÃ¼r DEMO eingestellt:"
        },
        {
          "block_type": "code",
          "content": "<logger\nname=\n\"de.s0ftw4re.system.ui.component.demo\"\nlevel=\n\"DEBUG\"\n></logger>\n<!--logger name=\"org.apache.cxf.services\" level=\"DEBUG\"/-->\n<logger\nname=\n\"de.s0ftw4re.system.ui\"\nlevel=\n\"DEBUG\"\n></logger>\n<logger\nname=\n\"de.s0ftw4re.system.jpql\"\nlevel=\n\"INFO\"\n></logger>\n<logger\nname=\n\"org.hibernate\"\nlevel=\n\"INFO\"\n></logger>\n<!-- <logger name=\"org.hibernate.SQL\" level=\"DEBUG\" ></logger> -->\n<!-- <logger name=\"org.jboss.as.ee\" level=\"DEBUG\"></logger> -->\n<!-- <logger name=\"org.hibernate\" level=\"INFO\"></logger> -->\n<!-- <logger name=\"org.jboss.jca\" level=\"INFO\"></logger> -->\n<!-- <logger name=\"com.arjuna\" level=\"INFO\"></logger> -->\n<!-- <logger name=\"de.s0ftw4re.system.jpql\" level=\"INFO\"></logger> -->\n<logger\nname=\n\"de.s0ftw4re.system.attach\"\nlevel=\n\"INFO\"\n></logger>\n<logger\nname=\n\"de.s0ftw4re.system.service\"\nlevel=\n\"INFO\"\n></logger>\n<logger\nname=\n\"org.springframework.orm\"\nlevel=\n\"INFO\"\n></logger>\n<!-- <logger name=\"org.apache.activemq\" level=\"INFO\"></logger> -->\n<logger\nname=\n\"de.s0ftw4re.system.log\"\nlevel=\n\"INFO\"\n></logger>\n<logger\nname=\n\"de.s0ftw4re.dapservice\"\nlevel=\n\"INFO\"\n></logger>\n<logger\nname=\n\"org.jboss\"\nlevel=\n\"INFO\"\n></logger>\n<logger\nname=\n\"org.springframework\"\nlevel=\n\"INFO\"\n></logger>\n<root\nlevel=\n\"WARN\"\n>\n<appender-ref\nref=\n\"RequestLogAppender\"\n></appender-ref>\n<appender-ref\nref=\n\"S0ftw4re-Ondemand-Appender\"\n></appender-ref>\n<appender-ref\nref=\n\"Stdout\"\n></appender-ref>\n</root>"
        },
        {
          "block_type": "paragraph",
          "content": "FÃ¼r PROD werden alle Logger auf ERROR gestellt!"
        }
      ]
    },
    {
      "heading": "module.xml (Oracle)",
      "blocks": [
        {
          "block_type": "paragraph",
          "content": "Konfigurationsdatei fÃ¼r den Oracle-Treiber im Wildfly."
        },
        {
          "block_type": "paragraph",
          "content": "Pfad: /opt/s0ftw4reweb/wildfly/modules/com/oracle/main"
        },
        {
          "block_type": "code",
          "content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<module\nxmlns=\n\"urn:jboss:module:1.9\"\nname=\n\"com.oracle\"\n>\n<resources>\n<resource-root\npath=\n\"ojdbc8.jar\"\n></resource-root>\n</resources>\n<dependencies>\n<module\nname=\n\"javax.api\"\n></module>\n<module\nname=\n\"javax.transaction.api\"\n></module>\n</dependencies>\n</module>"
        }
      ]
    },
    {
      "heading": "limits.conf",
      "blocks": [
        {
          "block_type": "paragraph",
          "content": "Steuert die Limits (z.B. Anzahl gleichzeitig geÃ¶ffneter Dateien) im System."
        },
        {
          "block_type": "paragraph",
          "content": "Pfad: /etc/security/limits.conf"
        },
        {
          "block_type": "paragraph",
          "content": "FÃ¼r den Betriebssystemnutzer s0ftw4re muss die Anzahl der offenen Dateien von 1024 (Standard) auf 8192 erhÃ¶ht werden."
        },
        {
          "block_type": "code",
          "content": "s0ftw4re Â Â Â Â Â Â Â Â soft Â Â Â Â Â nofile Â Â Â Â Â Â Â Â Â Â 8192\ns0ftw4re Â Â Â Â Â Â Â Â hard Â Â Â Â Â nofile Â Â Â Â Â Â Â Â Â Â 8192"
        },
        {
          "block_type": "list",
          "content": [
            "Konfigurationen",
            ".profile",
            "standalone.conf",
            "standalone.xml datasource HTTP-Listener Logdateien",
            "logback.xml",
            "module.xml (Oracle)",
            "limits.conf"
          ]
        }
      ]
    }
  ],
  "source_file": "KonfigurationsÃ¼bersicht.htm"
}